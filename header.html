<!DOCTYPE html>
<html><!-- InstanceBegin template="/Templates/as2-doc.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta charset="utf-8">
<link href="as2-doc.css" rel="stylesheet" type="text/css">
<script src="jquery.min.js" type="text/javascript"></script>
<script src="as2-doc.js" type="text/javascript"></script>
<!-- InstanceBeginEditable name="head" -->
<title>Lua Header</title>
<!-- InstanceEndEditable -->
</head>
<body>
<h1 id="about">About</h1>
<address>Author: <a href="index.html#contact">DeathByNukes</a></address>
<p>This is a part of my <a href="index.html">Audiosurf 2 scripting documentation</a>.</p>
<!-- InstanceBeginEditable name="pre-content" --><!-- InstanceEndEditable -->
<h1 id="contents">Contents</h1>
<script type="text/javascript">writeNavigation();</script>
<!-- InstanceBeginEditable name="content" -->
<h1 id="header">Header</h1>
<p>All AS2 Lua scripts have a built-in script added to the top of them:</p>
<pre class="NppLua"><code><span class="sc11">luanet</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">nil</span><span class="sc0">
</span><span class="sc11">package</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">nil</span><span class="sc0">
</span><span class="sc15">os.execute</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">nil</span><span class="sc0">
</span><span class="sc15">os.remove</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">nil</span><span class="sc0">
</span><span class="sc15">os.rename</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">nil</span><span class="sc0">
</span><span class="sc15">os.setlocale</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">nil</span><span class="sc0">
</span><span class="sc15">os.exit</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">nil</span><span class="sc0">
</span><span class="sc2">--prevent future packages from being loaded
</span><span class="sc13">require</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">nil</span><span class="sc0">
</span><span class="sc13">dofile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">nil</span><span class="sc0">
</span><span class="sc11">load</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">nil</span><span class="sc0">
</span><span class="sc13">loadfile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">nil</span><span class="sc0">
</span><span class="sc13">os</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">nil</span><span class="sc0">
</span><span class="sc13">io</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">nil</span><span class="sc0">

</span><span class="sc5">do</span><span class="sc0">
	</span><span class="sc5">local</span><span class="sc0"> </span><span class="sc11">auto</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">assign</span><span class="sc0">

	</span><span class="sc5">function</span><span class="sc0"> </span><span class="sc11">auto</span><span class="sc10">(</span><span class="sc11">tab</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">)</span><span class="sc0">
		</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc13">setmetatable</span><span class="sc10">({},</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
			</span><span class="sc11">__index</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">auto</span><span class="sc10">,</span><span class="sc0">
			</span><span class="sc11">__newindex</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">assign</span><span class="sc10">,</span><span class="sc0">
			</span><span class="sc11">parent</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">tab</span><span class="sc10">,</span><span class="sc0">
			</span><span class="sc11">key</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc0">
		</span><span class="sc10">})</span><span class="sc0">
	</span><span class="sc5">end</span><span class="sc0">

	</span><span class="sc5">local</span><span class="sc0"> </span><span class="sc11">meta</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">__index</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">auto</span><span class="sc10">}</span><span class="sc0">

	</span><span class="sc2">-- The if statement below prevents the table from being</span><span class="sc0">
	</span><span class="sc2">-- created if the value assigned is nil. This is, I think,</span><span class="sc0">
	</span><span class="sc2">-- technically correct but it might be desirable to use</span><span class="sc0">
	</span><span class="sc2">-- assignment to nil to force a table into existence.</span><span class="sc0">

	</span><span class="sc5">function</span><span class="sc0"> </span><span class="sc11">assign</span><span class="sc10">(</span><span class="sc11">tab</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">val</span><span class="sc10">)</span><span class="sc0">
		</span><span class="sc2">-- if val ~= nil then</span><span class="sc0">
		</span><span class="sc5">local</span><span class="sc0"> </span><span class="sc11">oldmt</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc13">getmetatable</span><span class="sc10">(</span><span class="sc11">tab</span><span class="sc10">)</span><span class="sc0">
		</span><span class="sc11">oldmt.parent</span><span class="sc10">[</span><span class="sc11">oldmt.key</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">tab</span><span class="sc0">
		</span><span class="sc13">setmetatable</span><span class="sc10">(</span><span class="sc11">tab</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">meta</span><span class="sc10">)</span><span class="sc0">
		</span><span class="sc11">tab</span><span class="sc10">[</span><span class="sc11">key</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">val</span><span class="sc0">
		</span><span class="sc2">-- end</span><span class="sc0">
	</span><span class="sc5">end</span><span class="sc0">

	</span><span class="sc5">function</span><span class="sc0"> </span><span class="sc11">AutomagicTable</span><span class="sc10">()</span><span class="sc0">
		</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc13">setmetatable</span><span class="sc10">({},</span><span class="sc0"> </span><span class="sc11">meta</span><span class="sc10">)</span><span class="sc0">
	</span><span class="sc5">end</span><span class="sc0">

	</span><span class="sc5">function</span><span class="sc0"> </span><span class="sc11">fif</span><span class="sc10">(</span><span class="sc11">test</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">if_true</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">if_false</span><span class="sc10">)</span><span class="sc0">
		</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc11">test</span><span class="sc0"> </span><span class="sc5">then</span><span class="sc0"> </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">if_true</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">if_false</span><span class="sc0"> </span><span class="sc5">end</span><span class="sc0">
	</span><span class="sc5">end</span><span class="sc0">

	</span><span class="sc5">function</span><span class="sc0"> </span><span class="sc11">deepcopy</span><span class="sc10">(</span><span class="sc11">orig</span><span class="sc10">)</span><span class="sc0">
		</span><span class="sc5">local</span><span class="sc0"> </span><span class="sc11">orig_type</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc13">type</span><span class="sc10">(</span><span class="sc11">orig</span><span class="sc10">)</span><span class="sc0">
		</span><span class="sc5">local</span><span class="sc0"> </span><span class="sc11">copy</span><span class="sc0">
		</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc11">orig_type</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc7">'table'</span><span class="sc0"> </span><span class="sc5">then</span><span class="sc0">
			</span><span class="sc11">copy</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{}</span><span class="sc0">
			</span><span class="sc5">for</span><span class="sc0"> </span><span class="sc11">orig_key</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">orig_value</span><span class="sc0"> </span><span class="sc5">in</span><span class="sc0"> </span><span class="sc13">next</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">orig</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">nil</span><span class="sc0"> </span><span class="sc5">do</span><span class="sc0">
				</span><span class="sc11">copy</span><span class="sc10">[</span><span class="sc11">deepcopy</span><span class="sc10">(</span><span class="sc11">orig_key</span><span class="sc10">)]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">deepcopy</span><span class="sc10">(</span><span class="sc11">orig_value</span><span class="sc10">)</span><span class="sc0">
			</span><span class="sc5">end</span><span class="sc0">
			</span><span class="sc13">setmetatable</span><span class="sc10">(</span><span class="sc11">copy</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">deepcopy</span><span class="sc10">(</span><span class="sc13">getmetatable</span><span class="sc10">(</span><span class="sc11">orig</span><span class="sc10">)))</span><span class="sc0">
		</span><span class="sc5">else</span><span class="sc0"> </span><span class="sc2">-- number, string, boolean, etc</span><span class="sc0">
			</span><span class="sc11">copy</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">orig</span><span class="sc0">
		</span><span class="sc5">end</span><span class="sc0">
		</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">copy</span><span class="sc0">
	</span><span class="sc5">end</span><span class="sc0">
</span><span class="sc5">end</span></code></pre>
<p>AutomagicTable matches the code found here: <a href="http://lua-users.org/wiki/AutomagicTables">http://lua-users.org/wiki/AutomagicTables</a></p>
<!-- InstanceEndEditable -->
</body>
<!-- InstanceEnd --></html>