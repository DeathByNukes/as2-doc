<!DOCTYPE html>
<html><!-- InstanceBegin template="/Templates/as2-doc.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta charset="utf-8">
<link href="as2-doc.css" rel="stylesheet" type="text/css">
<script src="jquery.min.js" type="text/javascript"></script>
<script src="as2-doc.js" type="text/javascript"></script>
<!-- InstanceBeginEditable name="head" -->
<title>Lua Scripts</title>
<style type="text/css">
	table.availability tbody tr td:nth-child(2) {
		/* status indicators */
		text-align: center;
	}
</style>
<!-- InstanceEndEditable -->
</head>
<body>
<h1 id="about">About</h1>
<address>Author: <a href="index.html#contact">DeathByNukes</a></address>
<p>This is a part of my <a href="index.html">Audiosurf 2 scripting documentation</a>.</p>
<!-- InstanceBeginEditable name="pre-content" -->
<p>This documentation is up to date as of January 2021.</p>
<!-- InstanceEndEditable -->
<h1 id="contents">Contents</h1>
<script type="text/javascript">writeNavigation();</script>
<!-- InstanceBeginEditable name="content" -->




<h1 id="environment">Lua Environment</h1>
<p>Audiosurf 2 scripts are written in the <a href="https://www.lua.org/manual/5.1/">Lua 5.1</a> programming language. Because <a href="https://steamcommunity.com/app/235800/workshop/">workshop</a> scripts are downloaded from strangers, Lua is "sandboxed": dangerous features like <code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-os.execute" class=func>os.execute</a></code> and <a href="https://www.lua.org/manual/5.1/luac.html">precompiled</a> scripts are removed to protect players from malware. Audiosurf 2 is built using the <a href="https://unity3d.com/">Unity</a> game engine and, at the time of writing, is using Unity version <a href="https://unity3d.com/get-unity/download/archive">2017.4.37</a>. The Unity engine is a <a href="https://en.wikipedia.org/wiki/Mono_(software)">Mono</a>-based environment (<a href="https://en.wikipedia.org/wiki/Common_Language_Infrastructure">CLI</a>/<a href="https://en.wikipedia.org/wiki/Common_Language_Runtime">CLR</a>) and so most code for it is written in the <a href="https://en.wikipedia.org/wiki/C_Sharp_(programming_language)">C#</a> programming language. Audiosurf 2 uses a library based on <a href="https://code.google.com/archive/p/luainterface/">LuaInterface</a> to integrate Lua into this environment.</p>
<p>LuaInterface is an old library designed to allow Lua scripts to work with the <a href="https://en.wikipedia.org/wiki/.NET_Framework">.NET Framework</a> (the first <a href="https://en.wikipedia.org/wiki/Common_Language_Infrastructure">CLI</a> implementation). The most popular current fork of LuaInterface is probably <a href="http://nlua.org/">NLua</a>, but <a href="https://github.com/DeathByNukes/MonoBoxedLua/tree/255cc8b56dd9532abcc83f904bdb75da9d579811">the fork</a> used by Audiosurf 2 is based on a <a href="https://github.com/stevedonovan/MonoLuaInterface">MonoLuaInterface</a> fork named <a href="https://bitbucket.org/sparklinlabs/monoboxedlua">MonoBoxedLua</a>.</p>
<p>One of the results of this setup is that many internal classes and objects can be directly passed from Audiosurf 2 to Lua code as <a href="https://www.lua.org/manual/5.1/manual.html#2.2">userdata</a> without writing a wrapper. I happen to know that in the past this wasn't done because of security concerns, but that was resolved sometime around 2017.</p>
<ul class=seealso>
	<li><a href="https://www.lua.org/manual/5.1/">Lua 5.1 Reference Manual</a></li>
</ul>




<h1 id="stdlib">Standard Library</h1>
<p>Here is the current availability of the Lua 5.1 standard functions and variables:</p>
<table class=availability>
	<thead>
		<tr><th>Name</th><th>Status</th><th>Notes</th></tr>
	</thead>
	<tbody>
		<tr id="stdlib-_G"                ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-_G"                 class=func>_G</a></code></td>                      <td>✔️</td><td>The standard contents of this table are listed <a href="#stdlib">here</a><span title=":)">.</span></td></tr>
		<tr id="stdlib-_VERSION"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-_VERSION"           class=func>_VERSION</a></code></td>                <td>✔️</td><td><code>"Lua 5.1"</code></td></tr>
		<tr id="stdlib-assert"            ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert"             class=func>assert</a></code></td>                  <td>✔️</td><td></td></tr>
		<tr id="stdlib-collectgarbage"    ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-collectgarbage"     class=func>collectgarbage</a></code></td>          <td>✔️</td><td></td></tr>
		<tr id="stdlib-dofile"            ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-dofile"             class=func>dofile</a></code></td>                  <td>⚠️</td><td>Not available in mods. Path is always relative to the main script file.</td></tr>
		<tr id="stdlib-error"             ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-error"              class=func>error</a></code></td>                   <td>✔️</td><td></td></tr>
		<tr id="stdlib-gcinfo"            ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#7.2"                    class=func>gcinfo</a></code> (shim)</td>           <td>✔️</td><td></td></tr>
		<tr id="stdlib-getfenv"           ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-getfenv"            class=func>getfenv</a></code></td>                 <td>✔️</td><td></td></tr>
		<tr id="stdlib-getmetatable"      ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-getmetatable"       class=func>getmetatable</a></code></td>            <td>✔️</td><td></td></tr>
		<tr id="stdlib-ipairs"            ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-ipairs"             class=func>ipairs</a></code></td>                  <td>✔️</td><td></td></tr>
		<tr id="stdlib-load"              ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-load"               class=func>load</a></code></td>                    <td>✔️</td><td></td></tr>
		<tr id="stdlib-loadfile"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-loadfile"           class=func>loadfile</a></code></td>                <td>⚠️</td><td>Not available in mods. Path is always relative to the main script file.</td></tr>
		<tr id="stdlib-loadlib"           ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#7.2"                    class=func>loadlib</a></code> (shim)</td>          <td>❌</td><td></td></tr>
		<tr id="stdlib-loadstring"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-loadstring"         class=func>loadstring</a></code></td>              <td>✔️</td><td></td></tr>
		<tr id="stdlib-module"            ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-module"             class=func>module</a></code></td>                  <td>❌</td><td></td></tr>
		<tr id="stdlib-newproxy"          ><td><code><a href="https://stackoverflow.com/questions/23592388"                      class=func>newproxy</a></code> (undocumented)</th> <td>✔️</td><td></td></tr>
		<tr id="stdlib-next"              ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-next"               class=func>next</a></code></td>                    <td>✔️</td><td></td></tr>
		<tr id="stdlib-pairs"             ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-pairs"              class=func>pairs</a></code></td>                   <td>✔️</td><td></td></tr>
		<tr id="stdlib-pcall"             ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-pcall"              class=func>pcall</a></code></td>                   <td>✔️</td><td></td></tr>
		<tr id="stdlib-print"             ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-print"              class=func>print</a></code></td>                   <td>⚠️</td><td><a href="skins.html#print">Skin</a> and <a href="mods.html#print">mod</a> environments replace it with inconsistent implementations.</td></tr>
		<tr id="stdlib-rawequal"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-rawequal"           class=func>rawequal</a></code></td>                <td>✔️</td><td></td></tr>
		<tr id="stdlib-rawget"            ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-rawget"             class=func>rawget</a></code></td>                  <td>✔️</td><td></td></tr>
		<tr id="stdlib-rawset"            ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-rawset"             class=func>rawset</a></code></td>                  <td>✔️</td><td></td></tr>
		<tr id="stdlib-require"           ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-require"            class=func>require</a></code></td>                 <td>❌</td><td></td></tr>
		<tr id="stdlib-select"            ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-select"             class=func>select</a></code></td>                  <td>✔️</td><td></td></tr>
		<tr id="stdlib-setfenv"           ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-setfenv"            class=func>setfenv</a></code></td>                 <td>✔️</td><td></td></tr>
		<tr id="stdlib-setmetatable"      ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-setmetatable"       class=func>setmetatable</a></code></td>            <td>✔️</td><td></td></tr>
		<tr id="stdlib-tonumber"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-tonumber"           class=func>tonumber</a></code></td>                <td>✔️</td><td></td></tr>
		<tr id="stdlib-tostring"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-tostring"           class=func>tostring</a></code></td>                <td>✔️</td><td></td></tr>
		<tr id="stdlib-type"              ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-type"               class=func>type</a></code></td>                    <td>✔️</td><td></td></tr>
		<tr id="stdlib-unpack"            ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-unpack"             class=func>unpack</a></code></td>                  <td>✔️</td><td></td></tr>
		<tr id="stdlib-xpcall"            ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-xpcall"             class=func>xpcall</a></code></td>                  <td>✔️</td><td></td></tr>
		<tr id="stdlib-coroutine"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-coroutine"          class=func>coroutine</a></code></td>               <td>✔️</td><td></td></tr>
		<tr id="stdlib-coroutine.create"  ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-coroutine.create"   class=func>coroutine.create</a></code></td>        <td>✔️</td><td></td></tr>
		<tr id="stdlib-coroutine.resume"  ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-coroutine.resume"   class=func>coroutine.resume</a></code></td>        <td>✔️</td><td></td></tr>
		<tr id="stdlib-coroutine.running" ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-coroutine.running"  class=func>coroutine.running</a></code></td>       <td>✔️</td><td></td></tr>
		<tr id="stdlib-coroutine.status"  ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-coroutine.status"   class=func>coroutine.status</a></code></td>        <td>✔️</td><td></td></tr>
		<tr id="stdlib-coroutine.wrap"    ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-coroutine.wrap"     class=func>coroutine.wrap</a></code></td>          <td>✔️</td><td></td></tr>
		<tr id="stdlib-coroutine.yield"   ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-coroutine.yield"    class=func>coroutine.yield</a></code></td>         <td>✔️</td><td></td></tr>
		<tr id="stdlib-debug"             ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-debug"              class=func>debug</a></code></td>                   <td>✔️</td><td></td></tr>
		<tr id="stdlib-debug.debug"       ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-debug.debug"        class=func>debug.debug</a></code></td>             <td>❌</td><td></td></tr>
		<tr id="stdlib-debug.getfenv"     ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-debug.getfenv"      class=func>debug.getfenv</a></code></td>           <td>❌</td><td></td></tr>
		<tr id="stdlib-debug.gethook"     ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-debug.gethook"      class=func>debug.gethook</a></code></td>           <td>❌</td><td></td></tr>
		<tr id="stdlib-debug.getinfo"     ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-debug.getinfo"      class=func>debug.getinfo</a></code></td>           <td>✔️</td><td></td></tr>
		<tr id="stdlib-debug.getlocal"    ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-debug.getlocal"     class=func>debug.getlocal</a></code></td>          <td>❌</td><td></td></tr>
		<tr id="stdlib-debug.getmetatable"><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-debug.getmetatable" class=func>debug.getmetatable</a></code></td>      <td>❌</td><td></td></tr>
		<tr id="stdlib-debug.getregistry" ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-debug.getregistry"  class=func>debug.getregistry</a></code></td>       <td>❌</td><td></td></tr>
		<tr id="stdlib-debug.getupvalue"  ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-debug.getupvalue"   class=func>debug.getupvalue</a></code></td>        <td>❌</td><td></td></tr>
		<tr id="stdlib-debug.setfenv"     ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-debug.setfenv"      class=func>debug.setfenv</a></code></td>           <td>❌</td><td></td></tr>
		<tr id="stdlib-debug.sethook"     ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-debug.sethook"      class=func>debug.sethook</a></code></td>           <td>❌</td><td></td></tr>
		<tr id="stdlib-debug.setlocal"    ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-debug.setlocal"     class=func>debug.setlocal</a></code></td>          <td>❌</td><td></td></tr>
		<tr id="stdlib-debug.setmetatable"><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-debug.setmetatable" class=func>debug.setmetatable</a></code></td>      <td>❌</td><td></td></tr>
		<tr id="stdlib-debug.setupvalue"  ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-debug.setupvalue"   class=func>debug.setupvalue</a></code></td>        <td>❌</td><td></td></tr>
		<tr id="stdlib-debug.traceback"   ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-debug.traceback"    class=func>debug.traceback</a></code></td>         <td>✔️</td><td></td></tr>
		<tr id="stdlib-io"                ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-io"                 class=func>io</a></code></td>                      <td>❌</td><td></td></tr>
		<tr id="stdlib-io.close"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-io.close"           class=func>io.close</a></code></td>                <td>❌</td><td></td></tr>
		<tr id="stdlib-io.flush"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-io.flush"           class=func>io.flush</a></code></td>                <td>❌</td><td></td></tr>
		<tr id="stdlib-io.input"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-io.input"           class=func>io.input</a></code></td>                <td>❌</td><td></td></tr>
		<tr id="stdlib-io.lines"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-io.lines"           class=func>io.lines</a></code></td>                <td>❌</td><td></td></tr>
		<tr id="stdlib-io.open"           ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-io.open"            class=func>io.open</a></code></td>                 <td>❌</td><td></td></tr>
		<tr id="stdlib-io.output"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-io.output"          class=func>io.output</a></code></td>               <td>❌</td><td></td></tr>
		<tr id="stdlib-io.popen"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-io.popen"           class=func>io.popen</a></code></td>                <td>❌</td><td></td></tr>
		<tr id="stdlib-io.read"           ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-io.read"            class=func>io.read</a></code></td>                 <td>❌</td><td></td></tr>
		<tr id="stdlib-io.stderr"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-io.stderr"          class=func>io.stderr</a></code></td>               <td>❌</td><td></td></tr>
		<tr id="stdlib-io.stdin"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-io.stdin"           class=func>io.stdin</a></code></td>                <td>❌</td><td></td></tr>
		<tr id="stdlib-io.stdout"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-io.stdout"          class=func>io.stdout</a></code></td>               <td>❌</td><td></td></tr>
		<tr id="stdlib-io.tmpfile"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-io.tmpfile"         class=func>io.tmpfile</a></code></td>              <td>❌</td><td></td></tr>
		<tr id="stdlib-io.type"           ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-io.type"            class=func>io.type</a></code></td>                 <td>❌</td><td></td></tr>
		<tr id="stdlib-io.write"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-io.write"           class=func>io.write</a></code></td>                <td>❌</td><td></td></tr>
		<tr id="stdlib-file:close"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-file:close"         class=func>file:close</a></code></td>              <td>❌</td><td></td></tr>
		<tr id="stdlib-file:flush"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-file:flush"         class=func>file:flush</a></code></td>              <td>❌</td><td></td></tr>
		<tr id="stdlib-file:lines"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-file:lines"         class=func>file:lines</a></code></td>              <td>❌</td><td></td></tr>
		<tr id="stdlib-file:read"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-file:read"          class=func>file:read</a></code></td>               <td>❌</td><td></td></tr>
		<tr id="stdlib-file:seek"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-file:seek"          class=func>file:seek</a></code></td>               <td>❌</td><td></td></tr>
		<tr id="stdlib-file:setvbuf"      ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-file:setvbuf"       class=func>file:setvbuf</a></code></td>            <td>❌</td><td></td></tr>
		<tr id="stdlib-file:write"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-file:write"         class=func>file:write</a></code></td>              <td>❌</td><td></td></tr>
		<tr id="stdlib-math"              ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math"               class=func>math</a></code></td>                    <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.abs"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.abs"           class=func>math.abs</a></code></td>                <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.acos"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.acos"          class=func>math.acos</a></code></td>               <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.asin"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.asin"          class=func>math.asin</a></code></td>               <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.atan"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.atan"          class=func>math.atan</a></code></td>               <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.atan2"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.atan2"         class=func>math.atan2</a></code></td>              <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.ceil"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.ceil"          class=func>math.ceil</a></code></td>               <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.cos"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.cos"           class=func>math.cos</a></code></td>                <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.cosh"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.cosh"          class=func>math.cosh</a></code></td>               <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.deg"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.deg"           class=func>math.deg</a></code></td>                <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.exp"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.exp"           class=func>math.exp</a></code></td>                <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.floor"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.floor"         class=func>math.floor</a></code></td>              <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.fmod"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.fmod"          class=func>math.fmod</a></code></td>               <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.frexp"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.frexp"         class=func>math.frexp</a></code></td>              <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.huge"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.huge"          class=func>math.huge</a></code></td>               <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.ldexp"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.ldexp"         class=func>math.ldexp</a></code></td>              <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.log"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.log"           class=func>math.log</a></code></td>                <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.log10"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.log10"         class=func>math.log10</a></code></td>              <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.max"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.max"           class=func>math.max</a></code></td>                <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.min"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.min"           class=func>math.min</a></code></td>                <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.mod"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#7.2"                    class=func>math.mod</a></code> (shim)</th>         <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.modf"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.modf"          class=func>math.modf</a></code></td>               <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.pi"           ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.pi"            class=func>math.pi</a></code></td>                 <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.pow"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.pow"           class=func>math.pow</a></code></td>                <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.rad"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.rad"           class=func>math.rad</a></code></td>                <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.random"       ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.random"        class=func>math.random</a></code></td>             <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.randomseed"   ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.randomseed"    class=func>math.randomseed</a></code></td>         <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.sin"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.sin"           class=func>math.sin</a></code></td>                <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.sinh"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.sinh"          class=func>math.sinh</a></code></td>               <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.sqrt"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.sqrt"          class=func>math.sqrt</a></code></td>               <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.tan"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.tan"           class=func>math.tan</a></code></td>                <td>✔️</td><td></td></tr>
		<tr id="stdlib-math.tanh"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.tanh"          class=func>math.tanh</a></code></td>               <td>✔️</td><td></td></tr>
		<tr id="stdlib-os"                ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-os"                 class=func>os</a></code></td>                      <td>✔️</td><td></td></tr>
		<tr id="stdlib-os.clock"          ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-os.clock"           class=func>os.clock</a></code></td>                <td>✔️</td><td></td></tr>
		<tr id="stdlib-os.date"           ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-os.date"            class=func>os.date</a></code></td>                 <td>✔️</td><td></td></tr>
		<tr id="stdlib-os.difftime"       ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-os.difftime"        class=func>os.difftime</a></code></td>             <td>✔️</td><td></td></tr>
		<tr id="stdlib-os.execute"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-os.execute"         class=func>os.execute</a></code></td>              <td>❌</td><td></td></tr>
		<tr id="stdlib-os.exit"           ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-os.exit"            class=func>os.exit</a></code></td>                 <td>❌</td><td></td></tr>
		<tr id="stdlib-os.getenv"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-os.getenv"          class=func>os.getenv</a></code></td>               <td>❌</td><td></td></tr>
		<tr id="stdlib-os.remove"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-os.remove"          class=func>os.remove</a></code></td>               <td>❌</td><td></td></tr>
		<tr id="stdlib-os.rename"         ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-os.rename"          class=func>os.rename</a></code></td>               <td>❌</td><td></td></tr>
		<tr id="stdlib-os.setlocale"      ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-os.setlocale"       class=func>os.setlocale</a></code></td>            <td>❌</td><td></td></tr>
		<tr id="stdlib-os.time"           ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-os.time"            class=func>os.time</a></code></td>                 <td>✔️</td><td></td></tr>
		<tr id="stdlib-os.tmpname"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-os.tmpname"         class=func>os.tmpname</a></code></td>              <td>❌</td><td></td></tr>
		<tr id="stdlib-package"           ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-package"            class=func>package</a></code></td>                 <td>❌</td><td></td></tr>
		<tr id="stdlib-package.cpath"     ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-package.cpath"      class=func>package.cpath</a></code></td>           <td>❌</td><td></td></tr>
		<tr id="stdlib-package.loaded"    ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-package.loaded"     class=func>package.loaded</a></code></td>          <td>❌</td><td></td></tr>
		<tr id="stdlib-package.loaders"   ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-package.loaders"    class=func>package.loaders</a></code></td>         <td>❌</td><td></td></tr>
		<tr id="stdlib-package.loadlib"   ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-package.loadlib"    class=func>package.loadlib</a></code></td>         <td>❌</td><td></td></tr>
		<tr id="stdlib-package.path"      ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-package.path"       class=func>package.path</a></code></td>            <td>❌</td><td></td></tr>
		<tr id="stdlib-package.preload"   ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-package.preload"    class=func>package.preload</a></code></td>         <td>❌</td><td></td></tr>
		<tr id="stdlib-package.seeall"    ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-package.seeall"     class=func>package.seeall</a></code></td>          <td>❌</td><td></td></tr>
		<tr id="stdlib-string"            ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-string"             class=func>string</a></code></td>                  <td>✔️</td><td></td></tr>
		<tr id="stdlib-string.byte"       ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-string.byte"        class=func>string.byte</a></code></td>             <td>✔️</td><td></td></tr>
		<tr id="stdlib-string.char"       ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-string.char"        class=func>string.char</a></code></td>             <td>✔️</td><td></td></tr>
		<tr id="stdlib-string.dump"       ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-string.dump"        class=func>string.dump</a></code></td>             <td>✔️</td><td></td></tr>
		<tr id="stdlib-string.find"       ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-string.find"        class=func>string.find</a></code></td>             <td>✔️</td><td></td></tr>
		<tr id="stdlib-string.format"     ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-string.format"      class=func>string.format</a></code></td>           <td>✔️</td><td></td></tr>
		<tr id="stdlib-string.gfind"      ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#7.2"                    class=func>string.gfind</a></code> (shim)</th>     <td>✔️</td><td></td></tr>
		<tr id="stdlib-string.gmatch"     ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-string.gmatch"      class=func>string.gmatch</a></code></td>           <td>✔️</td><td></td></tr>
		<tr id="stdlib-string.gsub"       ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-string.gsub"        class=func>string.gsub</a></code></td>             <td>✔️</td><td></td></tr>
		<tr id="stdlib-string.len"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-string.len"         class=func>string.len</a></code></td>              <td>✔️</td><td></td></tr>
		<tr id="stdlib-string.lower"      ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-string.lower"       class=func>string.lower</a></code></td>            <td>✔️</td><td></td></tr>
		<tr id="stdlib-string.match"      ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-string.match"       class=func>string.match</a></code></td>            <td>✔️</td><td></td></tr>
		<tr id="stdlib-string.rep"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-string.rep"         class=func>string.rep</a></code></td>              <td>✔️</td><td></td></tr>
		<tr id="stdlib-string.reverse"    ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-string.reverse"     class=func>string.reverse</a></code></td>          <td>✔️</td><td></td></tr>
		<tr id="stdlib-string.sub"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-string.sub"         class=func>string.sub</a></code></td>              <td>✔️</td><td></td></tr>
		<tr id="stdlib-string.upper"      ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-string.upper"       class=func>string.upper</a></code></td>            <td>✔️</td><td></td></tr>
		<tr id="stdlib-table"             ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-table"              class=func>table</a></code></td>                   <td>✔️</td><td></td></tr>
		<tr id="stdlib-table.concat"      ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-table.concat"       class=func>table.concat</a></code></td>            <td>✔️</td><td></td></tr>
		<tr id="stdlib-table.foreach"     ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#7.2"                    class=func>table.foreach</a></code> (shim)</th>    <td>✔️</td><td></td></tr>
		<tr id="stdlib-table.foreachi"    ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#7.2"                    class=func>table.foreachi</a></code> (shim)</th>   <td>✔️</td><td></td></tr>
		<tr id="stdlib-table.getn"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#7.2"                    class=func>table.getn</a></code> (shim)</th>       <td>✔️</td><td></td></tr>
		<tr id="stdlib-table.insert"      ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-table.insert"       class=func>table.insert</a></code></td>            <td>✔️</td><td></td></tr>
		<tr id="stdlib-table.maxn"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-table.maxn"         class=func>table.maxn</a></code></td>              <td>✔️</td><td></td></tr>
		<tr id="stdlib-table.remove"      ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-table.remove"       class=func>table.remove</a></code></td>            <td>✔️</td><td></td></tr>
		<tr id="stdlib-table.setn"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#7.2"                    class=func>table.setn</a></code> (obsolete)</th>   <td>⚠️</td><td>Exists but raises error: <code>'setn' is obsolete</code></td></tr>
		<tr id="stdlib-table.sort"        ><td><code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-table.sort"         class=func>table.sort</a></code></td>              <td>✔️</td><td></td></tr>
	</tbody>
</table>




<h1 id="LuaInterface">LuaInterface</h1>
<p> At the moment only a few <a href="#environment">CLI</a> types are directly exposed to scripts but, depending on what you are trying to do, they can provide critical functionality. If you happen to be familiar with C# code, it might be easiest for you to learn about it by browsing the unit tests <a href="https://github.com/DeathByNukes/MonoBoxedLua/tree/255cc8b56dd9532abcc83f904bdb75da9d579811/LuaInterfaceTest">here</a>.</p>


<h2 id="LuaInterface-luanet">Standard Library</h2>
<table class=availability>
	<thead>
		<tr><th>Name</th><th>Status</th><th>Notes</th></tr>
	</thead>
	<tbody>
		<tr id="LuaInterface-luanet-luanet"               ><td><code><a href="https://github.com/stevedonovan/MonoLuaInterface#lua-api"	class=func>luanet</a></code></td>                <td>⚠️</td><td>The <code>luanet</code> table doesn't exist but its contents (below) are global variables instead.</td></tr>
		<tr id="LuaInterface-luanet-ctype"                ><td><code><a href="https://github.com/stevedonovan/MonoLuaInterface#lua-api"	class=func>ctype</a></code></td>                 <td>✔️</td><td></td></tr>
		<tr id="LuaInterface-luanet-enum"                 ><td><code><a href="https://github.com/stevedonovan/MonoLuaInterface#lua-api"	class=func>enum</a></code></td>                  <td>✔️</td><td></td></tr>
		<tr id="LuaInterface-luanet-free_object"          ><td><code><a href="https://github.com/stevedonovan/MonoLuaInterface#lua-api"	class=func>free_object</a></code></td>           <td>❌</td><td></td></tr>
		<tr id="LuaInterface-luanet-get_constructor_bysig"><td><code><a href="https://github.com/stevedonovan/MonoLuaInterface#lua-api"	class=func>get_constructor_bysig</a></code></td> <td>✔️</td><td></td></tr>
		<tr id="LuaInterface-luanet-get_method_bysig"     ><td><code><a href="https://github.com/stevedonovan/MonoLuaInterface#lua-api"	class=func>get_method_bysig</a></code></td>      <td>✔️</td><td></td></tr>
		<tr id="LuaInterface-luanet-import_type"          ><td><code><a href="https://github.com/stevedonovan/MonoLuaInterface#lua-api"	class=func>import_type</a></code></td>           <td>⚠️</td><td>Exists, but no assemblies are loaded. Some <a href="#LuaInterface-whitelist">whitelisted types</a> can be imported though.</td></tr>
		<tr id="LuaInterface-luanet-load_assembly"        ><td><code><a href="https://github.com/stevedonovan/MonoLuaInterface#lua-api"	class=func>load_assembly</a></code></td>         <td>❌</td><td></td></tr>
		<tr id="LuaInterface-luanet-make_object"          ><td><code><a href="https://github.com/stevedonovan/MonoLuaInterface#lua-api"	class=func>make_object</a></code></td>           <td>❌</td><td></td></tr>
	</tbody>
</table>


<h2 id="LuaInterface-whitelist">Type Whitelist</h2>
<p>Audiosurf 2 has manually whitelisted some <a href="#environment">CLI</a> types so that they can be imported with <code><a href="#LuaInterface-luanet-import_type" class=func>import_type</a>(full_name)</code>:</p>
<table>
	<thead>
		<tr><th>Full Name</th><th>Common Name</th><th>Semantics</th><th>Lua Conversion</th></tr>
	</thead>
	<tbody>
		<tr id="LuaInterface-whitelist-System.Char"           ><td><code><a href="https://docs.microsoft.com/en-us/dotnet/api/system.char?view=netframework-2.0"     class=type>System.Char</a></code></td>            <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/char"                          class=type>char</a></code></td>           <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/struct"                                       class=type>struct</a></code></td>       <td><code>number</code></td>   </tr>
		<tr id="LuaInterface-whitelist-System.DateTime"       ><td><code><a href="https://docs.microsoft.com/en-us/dotnet/api/system.datetime?view=netframework-2.0" class=type>System.DateTime</a></code></td>        <td><code><span                                                                                                                   class=type>DateTime</span></code></td>    <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/struct"                                       class=type>struct</a></code></td>       <td><code>userdata</code></td> </tr>
		<tr id="LuaInterface-whitelist-System.Double"         ><td><code><a href="https://docs.microsoft.com/en-us/dotnet/api/system.double?view=netframework-2.0"   class=type>System.Double</a></code></td>          <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/floating-point-numeric-types"  class=type>double</a></code></td>         <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/struct"                                       class=type>struct</a></code></td>       <td><code>number</code></td>   </tr>
		<tr id="LuaInterface-whitelist-System.Int32"          ><td><code><a href="https://docs.microsoft.com/en-us/dotnet/api/system.int32?view=netframework-2.0"    class=type>System.Int32</a></code></td>           <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/integral-numeric-types"        class=type>int</a></code></td>            <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/struct"                                       class=type>struct</a></code></td>       <td><code>number</code></td>   </tr>
		<tr id="LuaInterface-whitelist-System.Math"           ><td><code><a href="https://docs.microsoft.com/en-us/dotnet/api/system.math?view=netframework-2.0"     class=type>System.Math</a></code></td>            <td><code><span                                                                                                                   class=type>Math</span></code></td>        <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/static-classes-and-static-class-members" class=type>static class</a></code></td> <td>n/a</td>                   </tr>
		<tr id="LuaInterface-whitelist-System.Object"         ><td><code><a href="https://docs.microsoft.com/en-us/dotnet/api/system.object?view=netframework-2.0"   class=type>System.Object</a></code></td>          <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/reference-types"               class=type>object</a></code></td>         <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/class"                                             class=type>class</a></code></td>        <td><code>userdata</code></td> </tr>
		<tr id="LuaInterface-whitelist-System.Single"         ><td><code><a href="https://docs.microsoft.com/en-us/dotnet/api/system.single?view=netframework-2.0"   class=type>System.Single</a></code></td>          <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/floating-point-numeric-types"  class=type>float</a></code></td>          <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/struct"                                       class=type>struct</a></code></td>       <td><code>number</code></td>   </tr>
		<tr id="LuaInterface-whitelist-System.TimeSpan"       ><td><code><a href="https://docs.microsoft.com/en-us/dotnet/api/system.timespan?view=netframework-2.0" class=type>System.TimeSpan</a></code></td>        <td><code><span                                                                                                                   class=type>TimeSpan</span></code></td>    <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/struct"                                       class=type>struct</a></code></td>       <td><code>userdata</code></td> </tr>
		<tr id="LuaInterface-whitelist-UnityEngine.Color32"   ><td><code><a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color32.html"        class=type>UnityEngine.Color32</a></code></td>    <td><code><span                                                                                                                   class=type>Color32</span></code></td>     <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/struct"                                       class=type>struct</a></code></td>       <td><code>userdata</code></td> </tr>
		<tr id="LuaInterface-whitelist-UnityEngine.Color"     ><td><code><a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color.html"          class=type>UnityEngine.Color</a></code></td>      <td><code><span                                                                                                                   class=type>Color</span></code></td>       <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/struct"                                       class=type>struct</a></code></td>       <td><code>userdata</code></td> </tr>
		<tr id="LuaInterface-whitelist-UnityEngine.Mathf"     ><td><code><a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Mathf.html"          class=type>UnityEngine.Mathf</a></code></td>      <td><code><span                                                                                                                   class=type>Mathf</span></code></td>       <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/static-classes-and-static-class-members" class=type>static class</a></code></td> <td>n/a</td>                   </tr>
		<tr id="LuaInterface-whitelist-UnityEngine.Quaternion"><td><code><a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Quaternion.html"     class=type>UnityEngine.Quaternion</a></code></td> <td><code><span                                                                                                                   class=type>Quaternion</span></code></td>  <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/struct"                                       class=type>struct</a></code></td>       <td><code>userdata</code></td> </tr>
		<tr id="LuaInterface-whitelist-UnityEngine.Vector2"   ><td><code><a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Vector2.html"        class=type>UnityEngine.Vector2</a></code></td>    <td><code><span                                                                                                                   class=type>Vector2</span></code></td>     <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/struct"                                       class=type>struct</a></code></td>       <td><code>userdata</code></td> </tr>
		<tr id="LuaInterface-whitelist-UnityEngine.Vector3"   ><td><code><a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Vector3.html"        class=type>UnityEngine.Vector3</a></code></td>    <td><code><span                                                                                                                   class=type>Vector3</span></code></td>     <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/struct"                                       class=type>struct</a></code></td>       <td><code>userdata</code></td> </tr>
		<tr id="LuaInterface-whitelist-UnityEngine.Vector4"   ><td><code><a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Vector4.html"        class=type>UnityEngine.Vector4</a></code></td>    <td><code><span                                                                                                                   class=type>Vector4</span></code></td>     <td><code><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/struct"                                       class=type>struct</a></code></td>       <td><code>userdata</code></td> </tr>
	</tbody>
</table>
<p>Lua function calls <a href="https://www.lua.org/manual/5.1/manual.html#2.5.8">don't require parentheses when there is only one argument and that argument is a table or string definition</a>. The idiom is to use <code><a href="#LuaInterface-luanet-import_type" class=func>import_type</a></code> like this:</p>
<pre class=LuaCode><code>Name = <a href="#LuaInterface-luanet-import_type" class=func>import_type</a> "Namespace.Name"</code></pre>
<p>There is no way to avoid LuaInterface auto conversions when working with the numeric types; even if you are passing the output of one CLI function directly to the arguments of another, it will still be converted to a Lua number (double) and back along the way. Their instance methods are effectively inaccessible. Importing those types might still be useful if you need to create CLI arrays of them or use their static members.</p>


<h2 id="LuaInterface-instances">Working with CLI Instances and Types</h2>
<p>The most common use case in Audiosurf 2 will be working with <a href="#environment">CLI</a> object instances returned by functions like <code><a href="skins.html#BuildMaterial" class=func>BuildMaterial</a>{}</code>, which returns an instance of the <code><a href="skins.html#type-UnityEngine.Material" class=type>UnityEngine.Material</a></code> class. CLI objects and classes can contain <strong>fields</strong>, <strong>properties</strong>, and <strong>methods</strong>. (There are other things but they aren't relevant to Audiosurf 2.) <strong>Fields</strong> are like Lua variables but they can only contain specific types. <strong>Properties</strong> look like fields and generally act like them, but reading and writing their value calls internal "get" and "set" functions rather than reading and writing to a variable. Some can also be read-only. <strong>Methods</strong> should be familiar to experienced Lua users; they are functions attached to an object and you call them in the format <code>instance:method()</code> as shorthand for passing the object as the function's first argument.</p>
<ul class=seealso>
	<li><a href="https://www.lua.org/pil/16.html">PIL 16 - Object-Oriented Programming</a></li>
</ul>
<p>The Lua object produced by <code><a href="#LuaInterface-luanet-import_type" class=func>import_type</a></code>, sometimes called a <code>ProxyType</code>, allows you to access the <strong>static</strong> members of a type (<code>Type.StaticMember</code>), construct new instances of a type (<code>Type(arguments)</code>), and construct CLI arrays of that type (<code>Type[number]</code>). Static members work like instance members, but they are global and you do not use colon (<code>:</code>) syntax to call <strong>static methods</strong>. This is different from the <code><a href="https://docs.microsoft.com/en-us/dotnet/api/system.type?view=netframework-2.0" class=type>System.Type</a></code> object, which is used to programmatically view the metadata and members of a type; to get that you can call <code>example:<a href="https://docs.microsoft.com/en-us/dotnet/api/system.object.gettype?view=netframework-2.0" class=func>GetType</a>()</code> on instances or <code><a href="#LuaInterface-luanet-ctype" class=func>ctype</a>(Example)</code> on types. (Advanced users: Accessing members via reflection has been <a href="https://github.com/DeathByNukes/MonoBoxedLua/blob/255cc8b56dd9532abcc83f904bdb75da9d579811/LuaInterface/ObjectTranslator.cs#L541">disabled</a>; anything in the <code>System.Reflection</code> namespace gets converted to a string rather than a userdata.)</p>


<h2 id="LuaInterface-example">Examples</h2>

<h3 id="LuaInterface-example-material">Materials</h2>
<pre class=LuaCode><code>local mat = <a href="skins.html#BuildMaterial" class=func>BuildMaterial</a>{
	shader = "<a href="shaders.html#shader-VertexColorUnlitTintedAddSmooth">VertexColorUnlitTintedAddSmooth</a>",
	texture = "<a href="engine.html#textures-special">&lt;ALBUMART&gt;</a>",
}

<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(mat.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Material-renderQueue.html" class=prop>renderQueue</a> == <a href="engine.html#render-queue">3000</a>) <em>-- Read instance property. (Basic <a href="#environment">CLI</a> number types are <a href="https://github.com/DeathByNukes/MonoBoxedLua/blob/255cc8b56dd9532abcc83f904bdb75da9d579811/LuaInterface/ObjectTranslator.cs#L497">automatically converted</a> to Lua numbers.)</em>
mat.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Material-renderQueue.html" class=prop>renderQueue</a> = 1000 <em>-- Set instance property. (Lua numbers are <a href="https://github.com/DeathByNukes/MonoBoxedLua/blob/255cc8b56dd9532abcc83f904bdb75da9d579811/LuaInterface/ObjectTranslator.cs#L392">automatically</a> <a href="https://github.com/DeathByNukes/MonoBoxedLua/blob/255cc8b56dd9532abcc83f904bdb75da9d579811/LuaInterface/CheckType.cs#L30">converted</a> to CLI numbers.)</em>
local tex = mat:<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Material.GetTexture.html" class=func>GetTexture</a>("_MainTex") <em>-- Call instance method.</em>

<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(<a href="https://www.lua.org/manual/5.1/manual.html#pdf-type" class=func>type</a>(mat) == 'userdata')
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(mat:<a href="https://docs.microsoft.com/en-us/dotnet/api/system.object.gettype?view=netframework-2.0" class=func>GetType</a>().<a href="https://docs.microsoft.com/en-us/dotnet/api/system.type.fullname?view=netframework-2.0" class=prop>FullName</a> == "UnityEngine.Material")
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(tex:<a href="https://docs.microsoft.com/en-us/dotnet/api/system.object.gettype?view=netframework-2.0" class=func>GetType</a>().<a href="https://docs.microsoft.com/en-us/dotnet/api/system.type.fullname?view=netframework-2.0" class=prop>FullName</a> == "UnityEngine.Texture2D")

Color = <a href="#LuaInterface-luanet-import_type" class=func>import_type</a> "UnityEngine.Color"

local sky_blue = <a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-ctor.html" class=func>Color</a>(0, 0.5, 1, 1) <em>-- Create a new UnityEngine.Color instance.</em>
local black = Color.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-black.html" class=prop>black</a> <em>-- Read static property.</em>
local dark_blue = Color.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color.Lerp.html" class=func>Lerp</a>(sky_blue, black, 0.5) <em>-- Call static method. (Static methods don't use colon syntax.)</em>

local w, h = tex.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Texture-width.html" class=prop>width</a>, tex.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Texture-height.html" class=prop>height</a>

<em>-- The pixels of normal textures are marked "<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/ImageConversion.LoadImage.html">non-readable</a>" but the &lt;ALBUMART&gt; texture settings generate a new unrestricted Texture2D every time you use them.</em>
tex:<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Texture2D.SetPixel.html" class=func>SetPixel</a>(0, h - 1, dark_blue) <em>-- Turn the top left pixel dark blue.</em>
tex:<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Texture2D.Apply.html" class=func>Apply</a>()</code></pre>

<h3 id="LuaInterface-example-advanced">Advanced</h2>
<pre class=LuaCode><code>Color = <a href="#LuaInterface-luanet-import_type" class=func>import_type</a> "UnityEngine.Color"
Object = <a href="#LuaInterface-luanet-import_type" class=func>import_type</a> "System.Object"

local blue = Color.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-blue.html" class=prop>blue</a>
local green = Color.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-green.html" class=prop>green</a>

<em>-- LuaInterface doesn't currently translate <a href="#environment">CLI</a> operator overloading into Lua operator overloading.</em>
<em>--local cyan = blue + green -- error("attempt to perform arithmetic on local 'blue' (a userdata value)")</em>

local cyan = Color.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-operator_add.html" class=func>op_Addition</a>(blue, green) <em>-- Full list of operator names is <a href="https://stackoverflow.com/a/11113450">here</a> and <a href="https://stackoverflow.com/a/3016653">here</a>.</em>
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(cyan.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-a.html" class=prop>a</a> == 2)
cyan.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-a.html" class=prop>a</a> = 1

<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(cyan:<a href="https://docs.microsoft.com/en-us/dotnet/api/system.valuetype.equals?view=netframework-2.0" class=func>Equals</a>(<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-ctor.html" class=func>Color</a>(0,1,1,1))) <em>-- Compare the colors by value.</em>
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(cyan:<a href="https://docs.microsoft.com/en-us/dotnet/api/system.valuetype.equals?view=netframework-2.0" class=func>Equals</a>(<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-ctor.html" class=func>Color</a>(0,1,1))) <em>-- Multiple constructors.</em>
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(<a href="https://www.lua.org/manual/5.1/manual.html#pdf-tostring" class=func>tostring</a>(cyan) == cyan:<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color.ToString.html" class=func>ToString</a>()) <em>-- LuaInterface implements the <a href="https://www.lua.org/manual/5.1/manual.html#pdf-tostring">tostring</a> metatable field.</em>
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(<a href="https://www.lua.org/manual/5.1/manual.html#pdf-tostring" class=func>tostring</a>(cyan) == "RGBA(0.000, 1.000, 1.000, 1.000)")

<em>-- Create CLI array of colors.</em>
local colors = Color[3] <em>-- Create CLI array of colors. Equivalent to <code>System.Array.<a href="https://docs.microsoft.com/en-us/dotnet/api/system.array.createinstance?view=netframework-2.0#System_Array_CreateInstance_System_Type_System_Int32_" class=func>CreateInstance</a>(<a href="#LuaInterface-luanet-ctype" class=func>ctype</a>(Color), 3)</code>.</em>
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(colors.<a href="https://docs.microsoft.com/en-us/dotnet/api/system.array.length?view=netframework-2.0" class=prop>Length</a> == 3)
<em>--assert(#colors == 3) -- error("attempt to get length of local 'colors' (a userdata value)")</em>
colors[0] = blue <em>-- CLI arrays start with zero.</em>
colors[1] = black <em>-- If you tried to assign some other type like "foo" or {0,0,0} it would cause an error.</em>
colors[2] = dark_blue

<em>-- LuaInterface is not able to translate CLI value types (aka <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/struct">struct</a>) to Lua in a way that preserves by-value semantics.
-- Each time a class or struct is passed from the CLI to Lua it creates a new <a href="https://www.lua.org/manual/5.1/manual.html#2.2">Lua userdata object</a>, which is a reference type like tables.
-- If the object is a class or was already <a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/types/boxing-and-unboxing">boxed</a> before being passed to Lua, <a href="https://stackoverflow.com/a/7150832">it is possible</a> for multiple Lua objects to refer to the same CLI object.</em>
local a, b, c, d, e, array
a = Color.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-white.html" class=prop>white</a> <em>-- New Lua object and new CLI object.</em>
b = Color.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-white.html" class=prop>white</a> <em>-- New Lua object and new CLI object, containing the same value.</em>
c = a <em>-- Reference to the same Lua object.</em>

array = Color[1]
array[0] = a <em>-- A specific type CLI variable stores structs by value.</em>
d = array[0] <em>-- New Lua object and new CLI object, containing the same value.</em>

array = Object[1]
array[0] = a <em>-- An Object type CLI variable <a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/types/boxing-and-unboxing">stores structs by reference</a>. LuaInterface userdata are Object type internally, so a new object will not be created here.</em>
e = array[0] <em>-- New Lua object containing a reference to the same CLI object.</em>

<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(a.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-r.html" class=prop>r</a> == 1 and b.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-r.html" class=prop>r</a> == 1 and c.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-r.html" class=prop>r</a> == 1 and d.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-r.html" class=prop>r</a> == 1 and e.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-r.html" class=prop>r</a> == 1)
a.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-r.html" class=prop>r</a> = 0
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(a.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-r.html" class=prop>r</a> == 0 and b.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-r.html" class=prop>r</a> == 1 and c.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-r.html" class=prop>r</a> == 0 and d.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-r.html" class=prop>r</a> == 1 and e.<a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/Color-r.html" class=prop>r</a> == 0)

<em>-- Currently equality operators are always reference comparison, but operator overloading may be implemented in the future so don't do this.</em>
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(a ~= b)

<em>-- This is the canonical way to compare Lua objects by reference but it insufficient for CLI types because
-- the same CLI object might be referenced by multiple Lua userdata objects.</em>
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(not <a href="https://www.lua.org/manual/5.1/manual.html#pdf-rawequal" class=func>rawequal</a>(a, b))
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(<a href="https://www.lua.org/manual/5.1/manual.html#pdf-rawequal" class=func>rawequal</a>(a, c))
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(not <a href="https://www.lua.org/manual/5.1/manual.html#pdf-rawequal" class=func>rawequal</a>(a, d))
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(not <a href="https://www.lua.org/manual/5.1/manual.html#pdf-rawequal" class=func>rawequal</a>(a, e))

<em>-- The correct way to compare CLI types by reference.</em>
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(not Object.<a href="https://docs.microsoft.com/en-us/dotnet/api/system.object.referenceequals?view=netframework-2.0" class=func>ReferenceEquals</a>(a, b))
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(Object.<a href="https://docs.microsoft.com/en-us/dotnet/api/system.object.referenceequals?view=netframework-2.0" class=func>ReferenceEquals</a>(a, c))
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(not Object.<a href="https://docs.microsoft.com/en-us/dotnet/api/system.object.referenceequals?view=netframework-2.0" class=func>ReferenceEquals</a>(a, d))
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(Object.<a href="https://docs.microsoft.com/en-us/dotnet/api/system.object.referenceequals?view=netframework-2.0" class=func>ReferenceEquals</a>(a, e))

<em>-- Accessing the array twice creates different objects.</em>
<a href="https://www.lua.org/manual/5.1/manual.html#pdf-assert" class=func>assert</a>(not Object.<a href="https://docs.microsoft.com/en-us/dotnet/api/system.object.referenceequals?view=netframework-2.0" class=func>ReferenceEquals</a>(colors[0], colors[0]))</code></pre>




<h1 id="header">Header</h1>
<p>These scripts run first inside skin and mod Lua environments:</p>


<h2 id="header-sandbox">Sandbox</h2>
<p>This chunk can be disabled by the command line flag <code>+disablemodsecuritysandbox</code>. That flag seems to have been neglected when the security system was upgraded, as this is the only part of the game that checks it.</p>
<pre class=LuaCode><code>
assert(nil == package)
assert(nil == io)
assert(nil == require)
assert(nil == module)

assert(nil == os.execute)
assert(nil == os.exit)
assert(nil == os.getenv)
assert(nil == os.remove)
assert(nil == os.rename)
assert(nil == os.setlocale)
assert(nil == os.tmpname)

assert(nil == luanet)
assert(nil == load_assembly)

--dofile = nil
--loadfile = nil</code></pre>


<h2 id="header-lib">Library</h2>
<pre class=LuaCode><code>


-- each DoString is a different Lua scope, no need for a giant do...end
local auto, assign

function auto(tab, key)
    return setmetatable({}, {
            __index = auto,
            __newindex = assign,
            parent = tab,
            key = key
    })
end

local meta = {__index = auto}

-- The if statement below prevents the table from being
-- created if the value assigned is nil. This is, I think,
-- technically correct but it might be desirable to use
-- assignment to nil to force a table into existence.

function assign(tab, key, val)
    -- if val ~= nil then
    local oldmt = getmetatable(tab)
    oldmt.parent[oldmt.key] = tab
    setmetatable(tab, meta)
    tab[key] = val
    -- end
end

function AutomagicTable()
    return setmetatable({}, meta)
end

function fif(test, if_true, if_false)
    if test then return if_true else return if_false end
end

function deepcopy(orig)
    local orig_type = type(orig)
    local copy
    if orig_type == 'table' then
        copy = {}
        for orig_key, orig_value in next, orig, nil do
            copy[deepcopy(orig_key)] = deepcopy(orig_value)
        end
        setmetatable(copy, deepcopy(getmetatable(orig)))
    else -- number, string, boolean, etc
        copy = orig
    end
    return copy
end


-- start coroutine helpers
-- This table is indexed by coroutine and simply contains the time at which the coroutine
-- should be woken up.
local WAITING_ON_TIME = WAITING_ON_TIME or {}

-- Keep track of how long the game has been running.
local CURRENT_TIME = CURRENT_TIME or 0

function waitSeconds(seconds)
    -- Grab a reference to the current running coroutine.
    local co = coroutine.running()

    -- If co is nil, that means we're on the main process, which isn't a coroutine and can't yield
    assert(co ~= nil, 'The main thread cannot wait!')

    -- Store the coroutine and its wakeup time in the WAITING_ON_TIME table
    local wakeupTime = CURRENT_TIME + seconds
    WAITING_ON_TIME[co] = wakeupTime

    -- And suspend the process
    return coroutine.yield(co)
end

function wakeUpWaitingThreads(deltaTime)
    -- This function should be called once per game logic update with the amount of time
    -- that has passed since it was last called
    CURRENT_TIME = CURRENT_TIME + deltaTime

    -- First, grab a list of the threads that need to be woken up. They'll need to be removed
    -- from the WAITING_ON_TIME table which we don't want to try and do while we're iterating
    -- through that table, hence the list.
    local threadsToWake = {}
    for co, wakeupTime in pairs(WAITING_ON_TIME) do
        if wakeupTime < CURRENT_TIME then
            table.insert(threadsToWake, co)
        end
    end

    -- Now wake them all up.
    for _, co in ipairs(threadsToWake) do
        WAITING_ON_TIME[co] = nil -- Setting a field to nil removes it from the table
        coroutine.resume(co)
    end
end

function runProcess(func)
    -- This function is just a quick wrapper to start a coroutine.
    local co = coroutine.create(func)
    return coroutine.resume(co)
end

local WAITING_ON_SIGNAL = WAITING_ON_SIGNAL or {}

function waitSignal(signalName)
    -- Same check as in waitSeconds; the main thread cannot wait
    local co = coroutine.running()
    assert(co ~= nil, 'The main thread cannot wait!')

    if WAITING_ON_SIGNAL[signalStr] == nil then
        -- If there wasn't already a list for this signal, start a new one.
        WAITING_ON_SIGNAL[signalName] = { co }
    else
        table.insert(WAITING_ON_SIGNAL[signalName], co)
    end

    return coroutine.yield()
end

function signal(signalName)
    local threads = WAITING_ON_SIGNAL[signalName]
    if threads == nil then return end

    WAITING_ON_SIGNAL[signalName] = nil
    for _, co in ipairs(threads) do
        coroutine.resume(co)
    end
end
--end coroutine helpers
</code></pre>
<p>AutomagicTable matches the code found here: <a href="http://lua-users.org/wiki/AutomagicTables">http://lua-users.org/wiki/AutomagicTables</a></p>


<h2 id="header-seed">Random Seed</h2>
<p>A Lua script line is generated that calls <code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.randomseed" class=func>math.randomseed</a>(n)</code> where <code>n</code> is the total length of the song, in seconds, with no decimal. (This is appropriate because <code><a href="https://www.lua.org/manual/5.1/manual.html#pdf-math.randomseed" class=func>math.randomseed</a></code> discards the fraction anyways.)</p>
<!-- InstanceEndEditable -->
</body>
<!-- InstanceEnd --></html>